<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Controle de acesso ao SOE</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{
      --bg-0:#f2f6ff;
      --bg-1:#eef2ff;
      --bg-2:#f6f8ff;

      --card: rgba(255,255,255,.88);
      --border: rgba(15,23,42,.10);

      --text:#0f172a;
      --muted:#5b6b86;

      --primary:#2563eb;
      --primary2:#7c3aed;
      --success:#16a34a;
      --danger:#ef4444;

      --shadow: 0 18px 45px rgba(15,23,42,.10);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(900px 420px at 12% 10%, rgba(37,99,235,.16), transparent 56%),
        radial-gradient(900px 420px at 92% 16%, rgba(124,58,237,.12), transparent 56%),
        linear-gradient(180deg, var(--bg-0), var(--bg-1) 55%, var(--bg-2));
      padding: 18px;
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .head{
      padding: 16px 18px;
      border-bottom: 1px solid var(--border);
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }

    .title{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .title .icon{
      width: 42px;
      height: 42px;
      border-radius: 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      color: var(--primary2);
      background: rgba(124,58,237,.12);
      border: 1px solid rgba(124,58,237,.16);
    }

    h1{ margin:0; font-size: 16px; }
    .sub{ margin:2px 0 0; color: var(--muted); font-size: 12px; }

    .content{ padding: 16px 18px; }

    .flash{
      margin: 0 0 14px;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(15,23,42,.04);
    }

    table{
      width: 100%;
      border-collapse: collapse;
      border-radius: 14px;
      overflow:hidden;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.75);
    }
    th, td{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(15,23,42,.06);
      text-align:left;
      font-size: 13px;
    }
    th{ font-size: 12px; color: var(--muted); background: rgba(15,23,42,.03); }

    .tag{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 800;
    }
    .tag.on{ background: rgba(22,163,74,.12); color: #166534; border:1px solid rgba(22,163,74,.20); }
    .tag.off{ background: rgba(239,68,68,.12); color: #991b1b; border:1px solid rgba(239,68,68,.20); }

    .form{
      margin-top: 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:stretch;
    }

    select, input{
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.85);
      outline:none;
      min-width: 210px;
    }
    input{ min-width: 220px; flex: 1; }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 8px;
      padding: 10px 12px;
      font-size: 12px;
      border-radius: 14px;
      border: 1px solid transparent;
      cursor:pointer;
      text-decoration:none;
      user-select:none;
      font-weight: 800;
      white-space: nowrap;
    }
    .btn-primary{
      color:#fff;
      background: linear-gradient(135deg, rgba(37,99,235,1), rgba(124,58,237,.95));
      border-color: rgba(37,99,235,.18);
    }
    .btn-neutral{
      color:#0b1220;
      background: rgba(15,23,42,.06);
      border-color: rgba(15,23,42,.10);
    }
    .btn:hover{ filter: brightness(0.98); }
  </style>
</head>
<body>

<div class="wrap">
  <div class="head">
    <div class="title">
      <div class="icon"><i class="fas fa-user-lock"></i></div>
      <div>
        <h1>Controle de acesso ao SOE</h1>
        <p class="sub">Somente o moderador <b>SAVIO</b> pode liberar/revogar o acesso total ao SOE.</p>
      </div>
    </div>

    <a class="btn btn-neutral" href="{{ url_for('dashboard_moderador') }}">
      <i class="fas fa-arrow-left"></i> Voltar
    </a>
  </div>

  <div class="content">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash">
          {% for m in messages %}<div>{{ m }}</div>{% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <table>
      <thead>
        <tr>
          <th>Login</th>
          <th>Tipo</th>
          <th>Acesso SOE</th>
        </tr>
      </thead>
      <tbody>
        {% for m in moderadores %}
          <tr>
            <td>{{ m.login }}</td>
            <td>{{ m.tipo }}</td>
            <td>
              {% if m.login|upper == 'SAVIO' %}
                <span class="tag on"><i class="fas fa-check"></i> TOTAL (fixo)</span>
              {% elif m.soe_liberado == 1 %}
                <span class="tag on"><i class="fas fa-check"></i> LIBERADO</span>
              {% else %}
                <span class="tag off"><i class="fas fa-lock"></i> BLOQUEADO</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <form method="POST" class="form">
      <select name="moderador_id" required>
        <option value="">Selecione um moderadorâ€¦</option>
        {% for m in moderadores %}
          {% if m.login|upper != 'SAVIO' %}
            <option value="{{ m.id }}">{{ m.login }} ({{ m.tipo }})</option>
          {% endif %}
        {% endfor %}
      </select>

      <select name="acao" required>
        <option value="liberar">Liberar SOE</option>
        <option value="revogar">Revogar SOE</option>
      </select>

      <input type="password" name="senha_savio" placeholder="Senha do SAVIO" required>

      <button type="submit" class="btn btn-primary">
        <i class="fas fa-check"></i> Aplicar
      </button>
    </form>
  </div>
</div>

</body>
</html>
