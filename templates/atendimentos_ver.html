<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ver Atendimento – ESCOLA CLASSE 16</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{
      --bg:#f3f4f6;
      --card:#ffffff;
      --border:#e5e7eb;
      --muted:#64748b;
      --text:#111827;
    }

    body { background: var(--bg); }

    /* Área central responsiva: ocupa bem no PC e não fica espremida no celular */
    .page-wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: clamp(12px, 2.5vw, 22px) clamp(10px, 2.5vw, 18px);
    }

    .card { border-radius: 16px; background: var(--card); }

    /* Cabeçalho responsivo */
    .page-header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }

    .page-title{
      display:flex;
      align-items:center;
      gap: 10px;
      margin:0;
      font-size: clamp(18px, 2.2vw, 22px);
      line-height: 1.2;
      color: var(--text);
    }

    /* Botões: lado a lado no PC, empilhados no celular */
    .header-actions{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .header-actions .btn{
      border-radius: 999px;
      white-space: nowrap;
    }

    /* Grid: 2 colunas no desktop, 1 no celular */
    .grid {
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 992px){
      .grid { gap: 12px; }
    }
    @media (max-width: 760px){
      .grid{ grid-template-columns: 1fr; }
      .header-actions{ width: 100%; }
      .header-actions .btn{ flex: 1; }
    }

    /* Blocos */
    .block {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: clamp(10px, 2vw, 14px);
      min-width: 0; /* importante p/ quebra correta no grid */
    }

    .label {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing:.05em;
      margin-bottom: 6px;
      line-height: 1.2;
    }

    .value {
      font-size: clamp(14px, 1.6vw, 15px);
      color: var(--text);
      line-height: 1.45;
      word-break: break-word;     /* quebra textos longos */
      overflow-wrap: anywhere;    /* evita estourar a tela */
    }

    .mono { font-variant-numeric: tabular-nums; }

    /* Campos longos: mantém quebras de linha e ainda quebra em palavras grandes */
    .preline{
      white-space: pre-line;
      word-break: break-word;
      overflow-wrap: anywhere;
    }

    /* Blocos que ocupam a largura total no grid */
    .span-all { grid-column: 1 / -1; }

    /* Pequenos detalhes */
    .muted-small{ color: var(--muted); font-size: 12px; }
  </style>
</head>
<body>

<div class="page-wrap">

  <div class="page-header">
    <h1 class="page-title">
      <i class="fa-solid fa-handshake-angle"></i>
      Ver Atendimento
    </h1>

    <div class="header-actions">
      <a href="{{ url_for('atendimentos_pdf', atendimento_id=at.id) }}" class="btn btn-outline-danger btn-sm">
        <i class="fa-solid fa-file-pdf me-1"></i>PDF
      </a>
      <a href="{{ url_for('atendimentos_historico') }}" class="btn btn-outline-secondary btn-sm">
        <i class="fa-solid fa-arrow-left-long me-1"></i>Voltar
      </a>
    </div>
  </div>

  <div class="card border-0 shadow-sm">
    <div class="card-body p-3 p-md-4">

      <div class="grid">

        <div class="block">
          <div class="label">Data / Hora</div>
          <div class="value mono">
            {{ at.data_atendimento }}
            {% if at.hora_atendimento %} • {{ at.hora_atendimento }}{% endif %}
          </div>
        </div>

        <div class="block">
          <div class="label">Turma</div>
          <div class="value">{{ at.turma_nome }} – {{ at.turma_turno }}</div>
        </div>

        <div class="block">
          <div class="label">Aluno(a)</div>
          <div class="value">{{ at.aluno_nome }}</div>
        </div>


        <div class="block">
          <div class="label">Responsável</div>
          <div class="value">
            {% if at.responsavel_nome %}
              {{ at.responsavel_nome }}
              {% if at.responsavel_parentesco %}
                ({{ at.responsavel_parentesco }})
              {% endif %}
            {% else %}
              —
            {% endif %}
          </div>
        </div>



        <div class="block span-all">
          <div class="label">Assunto</div>
          <div class="value">{{ at.assunto or '—' }}</div>
        </div>

        <div class="block span-all">
          <div class="label">Relato</div>
          <div class="value preline">{{ at.relato }}</div>
        </div>

        <div class="block span-all">
          <div class="label">Combinados do Atendimento</div>
          <div class="value preline">
            {% if at.combinados %}
              {{ at.combinados }}
            {% else %}
              <span class="text-muted">Nenhum combinado registrado.</span>
            {% endif %}
          </div>
        </div>

        <div class="block">
          <div class="label">Retorno previsto</div>
          <div class="value">
            {% if at.retorno_previsto %}
              Sim
              {% if at.retorno_em %}<div class="muted-small">Para: {{ at.retorno_em }}</div>{% endif %}
            {% else %}
              Não
            {% endif %}
          </div>
        </div>

        <div class="block">
          <div class="label">Reunião agendada</div>
          <div class="value">
            {% if at.reuniao_agendada %}
              Sim
              {% if at.reuniao_data %}<div class="muted-small">Para: {{ at.reuniao_data }}</div>{% endif %}
            {% else %}
              Não
            {% endif %}
          </div>
        </div>

        <div class="block">
          <div class="label">Envolve professor</div>
          <div class="value">
            {% if at.envolve_professor %}
              Sim
              {% if at.professor_nome %}<div class="muted-small">{{ at.professor_nome }}</div>{% endif %}
            {% else %}
              Não
            {% endif %}
          </div>
        </div>

        <div class="block">
          <div class="label">Protocolo</div>
          <div class="value">
            {% if at.protocolo %}{{ at.protocolo }}{% else %}—{% endif %}
          </div>
        </div>

        <div class="block span-all">
          <div class="label">Registrado por</div>
          <div class="value">
            {% if at.registrador_nome %}
              {{ at.registrador_nome }} — {{ at.registrador_cargo }}
            {% else %}
              —
            {% endif %}
          </div>
        </div>

      </div>

    </div>
  </div>

</div>

</body>
</html>
